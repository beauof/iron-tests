%===============================================================================
%===============================================================================
%
\clearpage
%
\subsection{Example-0201-u \texttt{[PLAUSIBLE]}}
%
Example uses generated or user-defined regular meshes in CHeart mesh format
and solves a static problem, i.e., applies the boundary conditions in one step.\\[3ex]
%
%===============================================================================
%
\subsubsection{Mathematical model - 3D}
%
We solve the following scalar equation,
%
\begin{align}
    \nabla \cdot \boldsymbol{P} (\boldsymbol{u}, t) = \boldsymbol{0} & &&\Omega = [0, L_X] \times [0, L_Y] \times [0, L_Z],
\end{align}
%
with 1st Piola-Kirchhoff stress tensor in $d$ dimensions,
%
\begin{align}
    \boldsymbol{P} &= \frac{2 \mu}{[\det F]^{2/d}} \left( \boldsymbol{F} - \frac{\boldsymbol{F} : \boldsymbol{F}}{d} \boldsymbol{F}^{-T} \right) + p \boldsymbol{F}^{-T}
\end{align}
%
corresponding to a Neo-Hookean constitutive law (Neo-Hooke parameter $\mu$)
with Dirichlet boundary conditions
%
\begin{align}
    u_x = 0 & &&X = 0, \\
    u_x = u_y = u_z = 0 & && X = Y = Z = 0, \\
		u_x = \lambda * L_X & &&X = L_X.
\end{align}
%
or Dirichlet/Neumann boundary conditions
%
\begin{align}
    u_x = 0 & &&X = 0, \\
    u_x = u_y = u_z = 0 & && X = Y = Z = 0, \\
		\boldsymbol{t} = \begin{bmatrix}
		  \mu (\lambda - \frac{\mu}{\lambda^2}) \\
		  0 \\
		  0
		\end{bmatrix} & &&X = L_X.
\end{align}
%
with stretch $\lambda$ and traction $\boldsymbol{t}$.

Note: The pressure has an opposite sign compared to CHeart and KerMOR.
%
%===============================================================================
%
\subsubsection{Computational model}
%
\begin{itemize}
    \item{Commandline arguments are:}
        \subitem{float: initial length along x-direction}
        \subitem{float: initial length along y-direction}
        \subitem{float: initial length along z-direction}
        \subitem{integer: number of elements in x-direction}
        \subitem{integer: number of elements in y-direction}
        \subitem{integer: number of elements in z-direction}
        \subitem{integer: solver type (0 - iterative, 1 - direct)}
        \subitem{integer: Jacobian type (0 - analytic, 1 - finite-difference)}
        \subitem{float: 1st Mooney-Rivlin parameter}
        \subitem{float: 2nd Mooney-Rivlin parameter (set to zero)}
        \subitem{integer: mesh type (0 - user-defined, 1 - generated)}
        \subitem{float: maximum stretch at right surface}
        \subitem{integer: number of load increments}
        \subitem{integer: BC type at right surface (0 - Dirichlet, 1 - Neumann\_integrated, 2 - Neumann\_point)}
    \item{Commandline arguments for tests are:}
        \subitem{see file run\_example.sh}
    \item{Note: Binary uses command line arguments to search for the relevant mesh files if user-defined meshes are selected.}
    \item{Note: BC type has not been implemented yet. Thus, it is not being tested.}
\end{itemize}
%
%===============================================================================
%
\subsubsection{Result summary}
%
We compare the solution vector (contains all displacement components and
pressure values) against an analytical solution with a tolerance of $10^{-11}$
on the normalized RMSE.
%
\verbatiminput{examples/example-0201-u/results/results.summary}
\verbatiminput{examples/example-0201-u/results/failed.tests}
%
\begin{figure}[h!]
    \centering 
    \includegraphics[width=0.9\columnwidth]{examples/example-0201-u/doc/figures/iron_reference_3D.eps} 
    \caption{3D results, iron reference.}
    \label{example-0201-u-iron-3D-reference-fig}
\end{figure}
%
%===============================================================================
%===============================================================================
